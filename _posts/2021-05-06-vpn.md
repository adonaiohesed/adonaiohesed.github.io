---
title: VPN
tags: VPN 
key: page-vpn
categories: [Cybersecurity, Network Security]
author: hyoeun
math: true
mathjax_autoNumber: true
---

# **Concepts and Security Mechanisms of VPNs (Virtual Private Networks)**

## **What is a VPN?**
A Virtual Private Network (VPN) is a technology that creates a secure private network connection over a public network (the internet). It enables secure communication as if using a dedicated private line.

### **Basic Concepts**
* Provides a secure communication environment over the public internet, similar to a dedicated line.
* Ensures confidentiality through data encryption.
* Controls access through user authentication.
* Provides data integrity verification.

## **How It Works**

### **1. Tunneling**
Tunneling is the core technology of a VPN, creating a virtual dedicated tunnel over a public network.

* **Encapsulation**: The process of wrapping an original data packet within a new packet.
* **Transmission**: The encapsulated packet is securely transmitted over the public network.
* **Decapsulation**: The process of extracting the original data packet at the destination.

### **2. Encryption Process**
VPNs use multiple stages of encryption to protect data securely.

1.  **Symmetric-key Encryption**
    * Used for data encryption.
    * Fast encryption/decryption speeds.
    * Performs encryption and decryption with the same key.

2.  **Public-key Encryption**
    * Used for the key exchange process.
    * Establishes a secure initial connection.
    * Forms a secure channel for sharing the symmetric key.

## **Types of VPNs**

### **1. Remote Access VPN**
* Allows individual users to connect to a company network remotely.
* A solution for employees who are working from home or traveling.
* Based on a client-server model.

### **2. Site-to-Site VPN**
* Connects the networks of two different locations.
* Used for secure communication between a headquarters and a branch office.
* Implemented at the router or firewall level.

### **3. Dynamic VPN**
* Establishes connections dynamically as needed.
* Allows for efficient use of resources.
* Enables flexible network configurations.

## **Key Protocols**

### **1. IPSec (Internet Protocol Security)**
* Operates at the network layer.
* Provides strong security.
* Supports two modes:
    * **Transport Mode**: Encrypts only the data payload.
    * **Tunnel Mode**: Encrypts the entire IP packet.

### **2. SSL/TLS VPN**
* Operates at the application layer.
* Allows access through a web browser.
* May not require client software installation.

### **3. L2TP/IPSec**
* Combines the tunneling of the data link layer with the security of IPSec.
* Offers strong security and compatibility.

## **Implementing Security Through a VPN**

### **1. Data Security**
* **Confidentiality**: Protects data from third parties through encryption.
* **Integrity**: Verifies whether data has been tampered with.
* **Availability**: Ensures stable access to services.

### **2. Access Control**
* **User Authentication**: Verifies identity through ID/password, certificates, etc.
* **Authorization**: Controls the access rights of authenticated users.
* **Connection Logging**: Records all connection attempts and activities.

### **3. Network Security**
* **IP Address Masking**: Hides the actual internal IP address from the outside.
* **Firewall Integration**: Interoperates with existing security infrastructure.
* **Traffic Encryption**: Encrypts all network traffic.

## **Advantages of Using a VPN**

1.  **Cost-Effectiveness**
    * Lower implementation cost compared to dedicated lines.
    * Flexible scalability.
    * Reduced management costs.

2.  **Security**
    * End-to-end encryption.
    * Centralized application of security policies.
    * Easy auditing and monitoring.

3.  **Flexibility**
    * Supports various access environments.
    * Enables remote work.
    * Scalable architecture.

## **How to Set Up a VPN: A Step-by-Step Guide**

There are various ways to set up a VPN, from simple methods for individual users to complex configurations where experts build their own servers. Here, we'll guide you through two representative approaches.

### **Method 1: Using a Commercial VPN Service (For Individuals/Small Teams)**

This is the easiest and fastest way to use a VPN. It's suitable for general users without extensive technical knowledge.

* **Step 1: Choose a Trustworthy Service**
    This is the most critical step from a security perspective. When choosing a service, you must consider the following:
    * **No-Logs Policy**: Check that the service has a clear policy of not storing user activity logs and whether it has been audited by an external party.
    * **Strong Encryption and Protocols**: Ensure it supports **AES-256** encryption and modern security protocols like **OpenVPN** and **WireGuard**.
    * **Jurisdiction**: A service headquartered in a country not part of data-sharing agreements (like the 5, 9, or 14 Eyes alliances) may be more favorable for privacy protection.
    * **Kill Switch**: This feature automatically cuts off your internet connection if the VPN disconnects unexpectedly, preventing your real IP address from being exposed.

* **Step 2: Sign Up and Install the Client**
    After signing up for a plan on the chosen service's website, download and install the dedicated client software for your device (PC, smartphone, tablet, etc.).

* **Step 3: Connect and Use**
    Run the installed client, log in, select a server in your desired country, and click the 'Connect' button to activate the VPN connection immediately.

### **Method 2: Building a Self-Hosted VPN Server (For Experts/Businesses)**

This method is suitable for experts who want complete control and transparency or for businesses looking to build their own security infrastructure. Here, we'll use the most widely used open-source solution, **OpenVPN**, as an example.

* **Step 1: Prepare a Server**
    You need a computer to act as the VPN server. You can create a virtual server (instance) on a cloud service like **AWS, Google Cloud, or DigitalOcean**, or prepare a physical server in-house. For the operating system, an **Ubuntu Server LTS** version is recommended for its stability and extensive documentation.

* **Step 2: Install OpenVPN and Set Up a Certificate Authority (CA)**
    Install the OpenVPN package on the server. Since OpenVPN uses a Public Key Infrastructure (PKI), you need to set up your own Certificate Authority (CA) to issue and sign certificates for the server and clients. This process can be somewhat complex, but scripts like `Easy-RSA` can simplify the procedure.

* **Step 3: Generate Server and Client Certificates/Keys**
    Using the CA you set up, generate a server certificate and private key, as well as unique certificates and keys for each client (user) that will connect to the VPN.

* **Step 4: Create Server and Client Configuration Files**
    * **Server Configuration (`server.conf`)**: Create a configuration file that specifies the port and protocol (UDP/TCP) the VPN will use, the virtual IP range, and the paths to the server certificate and key files.
    * **Client Configuration (`.ovpn`)**: Create a profile file containing the information the client needs to connect to the server. This file includes the server's public IP address, port, and the contents of the client's certificate and key. This `.ovpn` file must be securely distributed to each user.

* **Step 5: Configure the Network and Firewall**
    You must allow the port used by OpenVPN (e.g., UDP 1194) in the server's firewall. Additionally, you need to enable **IP forwarding** and set up **NAT (Network Address Translation)** rules so that VPN clients can access the internet through the server.

* **Step 6: Run the Service and Connect Clients**
    Start the OpenVPN service on the server. Then, install the OpenVPN client program on each user's device and connect to the server using the distributed `.ovpn` profile file.

## **Limitations**

1.  **Performance**
    * Processing delays due to encryption/decryption.
    * Performance variations depending on internet speed.
    * Potential bandwidth limitations.

2.  **Compatibility**
    * Compatibility issues between different VPN solutions.
    * Restrictions in some network environments.
    * Potential conflicts with firewall policies.

---

# **VPN(Virtual Private Network)의 개념과 보안 메커니즘**

## **VPN이란?**
Virtual Private Network(VPN)는 공용 네트워크(인터넷)를 통해 안전한 사설 네트워크 연결을 구현하는 기술입니다. 마치 전용선을 사용하는 것처럼 보안성이 보장된 통신을 가능하게 합니다.

### **기본 개념**
* 공용 인터넷을 통해 마치 전용선처럼 안전한 통신 환경 제공
* 데이터 암호화를 통한 기밀성 보장
* 사용자 인증을 통한 접근 제어
* 데이터 무결성 검증 제공

## **작동 원리**

### **1. 터널링**
터널링은 VPN의 핵심 기술로, 공용 네트워크 상에 가상의 전용 통로를 만드는 기술입니다.

* **캡슐화**: 원본 데이터 패킷을 새로운 패킷으로 감싸는 과정
* **전송**: 캡슐화된 패킷이 공용 네트워크를 통해 안전하게 전송
* **역캡슐화**: 목적지에서 원본 데이터 패킷을 추출하는 과정

### **2. 암호화 과정**
VPN은 데이터를 안전하게 보호하기 위해 여러 단계의 암호화를 사용합니다.

1.  **대칭키 암호화**
    * 데이터 암호화에 사용
    * 빠른 암호화/복호화 속도
    * 동일한 키로 암호화와 복호화 수행

2.  **공개키 암호화**
    * 키 교환 과정에 사용
    * 안전한 초기 연결 설정
    * 대칭키 공유를 위한 보안 채널 형성

## **VPN 유형**

### **1. 원격 접속 VPN (Remote Access VPN)**
* 개별 사용자가 회사 네트워크에 원격으로 접속
* 재택근무나 출장 중인 직원들을 위한 솔루션
* 클라이언트-서버 모델 기반

### **2. Site-to-Site VPN**
* 두 지점의 네트워크를 연결
* 본사와 지사 간의 안전한 통신에 사용
* 라우터나 방화벽 단에서 구현

### **3. 동적 VPN**
* 필요할 때마다 동적으로 연결 설정
* 리소스 효율적인 사용
* 유연한 네트워크 구성 가능

## **주요 프로토콜**

### **1. IPSec (Internet Protocol Security)**
* 네트워크 계층에서 동작
* 강력한 보안성 제공
* 두 가지 모드 지원:
    * 전송 모드: 데이터만 암호화
    * 터널 모드: 전체 IP 패킷 암호화

### **2. SSL/TLS VPN**
* 응용 계층에서 동작
* 웹 브라우저를 통한 접근 가능
* 클라이언트 소프트웨어 설치 불필요할 수 있음

### **3. L2TP/IPSec**
* 데이터 링크 계층의 터널링과 IPSec의 보안 결합
* 강력한 보안성과 호환성 제공

## **VPN을 통한 보안 구현**

### **1. 데이터 보안**
* **기밀성**: 암호화를 통해 데이터를 제3자로부터 보호
* **무결성**: 데이터 변조 여부를 검증
* **가용성**: 안정적인 서비스 접근 보장

### **2. 접근 제어**
* **사용자 인증**: ID/비밀번호, 인증서 등을 통한 신원 확인
* **권한 관리**: 인증된 사용자의 접근 권한 제어
* **접속 로깅**: 모든 접속 시도와 활동 기록

### **3. 네트워크 보안**
* **IP 주소 숨김**: 실제 내부 IP 주소를 외부로부터 보호
* **방화벽 통합**: 기존 보안 인프라와의 연동
* **트래픽 암호화**: 모든 네트워크 트래픽의 암호화

## **VPN 사용의 장점**

1.  **비용 효율성**
    * 전용선 대비 낮은 구축 비용
    * 유연한 확장성
    * 관리 비용 절감

2.  **보안성**
    * 종단 간 암호화
    * 중앙화된 보안 정책 적용
    * 감사 및 모니터링 용이

3.  **유연성**
    * 다양한 접속 환경 지원
    * 원격 근무 지원
    * 확장 가능한 구조

## **VPN 구축 방법: 단계별 가이드**

VPN을 구축하는 방법은 개인 사용자를 위한 간편한 방법부터 전문가가 직접 서버를 구성하는 복잡한 방법까지 다양합니다. 여기서는 두 가지 대표적인 접근 방식을 단계별로 안내합니다.

### **방법 1: 상용 VPN 서비스 이용하기 (개인/소규모 팀)**

가장 쉽고 빠르게 VPN을 사용하는 방법입니다. 기술적인 지식이 많지 않은 일반 사용자에게 적합합니다.

* **1단계: 신뢰할 수 있는 서비스 선택**
    보안 관점에서 가장 중요한 단계입니다. 서비스 선택 시 다음을 반드시 고려해야 합니다.
    * **노-로그 정책 (No-Logs Policy)**: 사용자의 활동 기록을 저장하지 않는다는 정책을 명확히 하고, 외부 기관의 감사를 받았는지 확인합니다.
    * **강력한 암호화 및 프로토콜**: **AES-256** 암호화와 **OpenVPN**, **WireGuard**와 같은 최신 보안 프로토콜을 지원하는지 확인합니다.
    * **관할권 (Jurisdiction)**: 데이터 공유 협약(5 아이즈, 9 아이즈, 14 아이즈)이 없는 국가에 본사를 둔 서비스가 프라이버시 보호에 더 유리할 수 있습니다.
    * **킬 스위치 (Kill Switch)**: VPN 연결이 갑자기 끊겼을 때 인터넷 연결을 자동으로 차단하여 실제 IP 주소가 노출되는 것을 방지하는 기능입니다.

* **2단계: 가입 및 클라이언트 설치**
    선택한 서비스의 웹사이트에서 요금제에 가입한 후, 사용하려는 기기(PC, 스마트폰, 태블릿 등)에 맞는 전용 클라이언트 소프트웨어를 다운로드하여 설치합니다.

* **3단계: 연결 및 사용**
    설치된 클라이언트를 실행하고 로그인한 뒤, 원하는 국가의 서버를 선택하여 '연결(Connect)' 버튼을 누르면 즉시 VPN 연결이 활성화됩니다.

### **방법 2: 자체 호스팅 VPN 서버 구축하기 (전문가/기업)**

완벽한 제어권과 투명성을 원하는 전문가나 자체 보안 인프라를 구축하려는 기업에 적합한 방법입니다. 여기서는 가장 널리 쓰이는 오픈소스 솔루션인 **OpenVPN**을 예로 들어 설명합니다.

* **1단계: 서버 준비**
    VPN 서버 역할을 할 컴퓨터가 필요합니다. **AWS, Google Cloud, DigitalOcean** 같은 클라우드 서비스에서 가상 서버(인스턴스)를 생성하거나, 사내에 물리적 서버를 준비합니다. 운영체제는 안정성과 자료가 풍부한 **Ubuntu Server LTS** 버전을 추천합니다.

* **2단계: OpenVPN 및 인증 기관(CA) 설정**
    서버에 OpenVPN 패키지를 설치합니다. OpenVPN은 공개 키 기반 구조(PKI)를 사용하므로, 서버와 클라이언트의 인증서를 발급하고 서명할 자체 인증 기관(CA)을 설정해야 합니다. 이 과정은 다소 복잡하지만, `Easy-RSA`와 같은 스크립트를 사용하면 절차를 간소화할 수 있습니다.

* **3단계: 서버 및 클라이언트 인증서/키 생성**
    설정한 CA를 통해 서버용 인증서와 개인 키, 그리고 VPN에 접속할 각 클라이언트(사용자)를 위한 고유한 인증서와 키를 각각 생성합니다.

* **4. 서버 및 클라이언트 구성 파일 작성**
    * **서버 구성 (`server.conf`)**: VPN이 사용할 포트, 프로토콜(UDP/TCP), 가상 IP 대역, 그리고 서버 인증서 및 키 파일의 경로 등을 지정하는 설정 파일을 작성합니다.
    * **클라이언트 구성 (`.ovpn`)**: 클라이언트가 서버에 접속하는 데 필요한 정보를 담은 프로필 파일을 생성합니다. 이 파일에는 서버의 공인 IP 주소, 포트, 그리고 클라이언트의 인증서 및 키 내용이 포함됩니다. 이 `.ovpn` 파일은 각 사용자에게 안전하게 배포되어야 합니다.

* **5단계: 네트워크 및 방화벽 설정**
    서버의 방화벽에서 OpenVPN이 사용하는 포트(예: UDP 1194)를 허용해야 합니다. 또한, VPN 클라이언트가 서버를 통해 인터넷에 접속할 수 있도록 **IP 포워딩**을 활성화하고 **NAT(네트워크 주소 변환)** 규칙을 설정해야 합니다.

* **6단계: 서비스 실행 및 클라이언트 연결**
    서버에서 OpenVPN 서비스를 시작하고, 각 사용자 기기에 OpenVPN 클라이언트 프로그램을 설치한 뒤 배포받은 `.ovpn` 파일을 통해 서버에 접속합니다.

## **제한사항**

1.  **성능**
    * 암호화/복호화로 인한 처리 지연
    * 인터넷 속도에 따른 성능 변화
    * 대역폭 제한 가능성

2.  **호환성**
    * 서로 다른 VPN 솔루션 간 호환성 문제
    * 일부 네트워크 환경에서의 제한
    * 방화벽 정책과의 충돌 가능성